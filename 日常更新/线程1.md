##  线程1

##  线程的概念

1.在进程内部运行的执行流

2.线程比进程粒度更细，调度成本更低

3.线程是cpu调度的基本单位。

##  什么是线程

**线程是CPU调度的基本单位。**

在Linux上认为，没有进程和线程概念上的区分，只有一个 叫做**执行流**。

所以Linux中不存在真正意义上的线程。

Linux的线程是用**进程的PCB**模拟的。

所以在Linux中没有真正的tcb。他就是PCB！但是不能说Linux没有tcb。

在Linux中PCB就是tcb，两个是同一个。

因为线程和进程在属性上大部分都是重叠的。可以直接复用。

这样的好处是不用编写大量的调度算法。等等



##  曾经的进程的理解

进程的最大的意义不是被执行，**而是向系统申请资源的基本单位**。不要理解进程就是task_struct这样理解太肤浅了。

而应该把task_struct+虚拟内存+页表+数据代码看做都是进程。

执行流也是进程内的资源。

![image-20231003230241437](E:\markdown\图片\image-20231003230241437.png)

##  如何证明

 

##  线程的接口

Linux没有提供直接的线程系统接口。而是原生提供的**线程库**。

这是由程序员来提供的，这是现在所有操作系统都必带的库。是一个动态库

![image-20231003231214537](E:\markdown\图片\image-20231003231214537.png)

创建一个线程。

线程和进程一样，也需要等待。

运行的时候需要加上动态库 -lpthread 选项。

C++11里面也有一个线程库。比如以下lambda表达式的例子。

![image-20231003233026866](E:\markdown\图片\image-20231003233026866.png)

![image-20231003233107879](E:\markdown\图片\image-20231003233107879.png)



这两个库的关系就是C++11**封装**的Linux的库。

##  查看轻量级进程

ps -aL 

a代表all，L代表轻的意思。

PID和LWP一样的就是主线程。可以看到pid一样的是属于同一个进程

![image-20231003232200930](E:\markdown\图片\image-20231003232200930.png)

每一个线程谁先执行都是未知的。

